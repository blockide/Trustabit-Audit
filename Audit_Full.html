<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=lhDjYqiy3mZ0x6ROQEUoUw');ul.lst-kix_yxtqdenm9vwf-0{list-style-type:none}ul.lst-kix_yxtqdenm9vwf-5{list-style-type:none}ul.lst-kix_yxtqdenm9vwf-6{list-style-type:none}ul.lst-kix_yxtqdenm9vwf-7{list-style-type:none}ul.lst-kix_yxtqdenm9vwf-8{list-style-type:none}ul.lst-kix_yxtqdenm9vwf-1{list-style-type:none}ul.lst-kix_yxtqdenm9vwf-2{list-style-type:none}ul.lst-kix_yxtqdenm9vwf-3{list-style-type:none}ul.lst-kix_yxtqdenm9vwf-4{list-style-type:none}.lst-kix_qlsefhda3coc-0>li:before{content:"\0025cf  "}.lst-kix_qlsefhda3coc-1>li:before{content:"\0025cb  "}.lst-kix_qlsefhda3coc-2>li:before{content:"\0025a0  "}.lst-kix_qlsefhda3coc-3>li:before{content:"\0025cf  "}.lst-kix_qlsefhda3coc-5>li:before{content:"\0025a0  "}.lst-kix_qlsefhda3coc-6>li:before{content:"\0025cf  "}.lst-kix_qlsefhda3coc-4>li:before{content:"\0025cb  "}ul.lst-kix_40j8fboaaegi-1{list-style-type:none}ul.lst-kix_40j8fboaaegi-2{list-style-type:none}.lst-kix_b58kovzf3v0p-4>li:before{content:"\0025cb  "}ul.lst-kix_40j8fboaaegi-0{list-style-type:none}.lst-kix_b58kovzf3v0p-5>li:before{content:"\0025a0  "}.lst-kix_qlsefhda3coc-7>li:before{content:"\0025cb  "}.lst-kix_b58kovzf3v0p-7>li:before{content:"\0025cb  "}.lst-kix_b58kovzf3v0p-6>li:before{content:"\0025cf  "}.lst-kix_b58kovzf3v0p-8>li:before{content:"\0025a0  "}.lst-kix_qlsefhda3coc-8>li:before{content:"\0025a0  "}ul.lst-kix_82io1qj7fu80-0{list-style-type:none}ul.lst-kix_82io1qj7fu80-3{list-style-type:none}ul.lst-kix_82io1qj7fu80-4{list-style-type:none}ul.lst-kix_82io1qj7fu80-1{list-style-type:none}ul.lst-kix_82io1qj7fu80-2{list-style-type:none}ul.lst-kix_82io1qj7fu80-7{list-style-type:none}ul.lst-kix_82io1qj7fu80-8{list-style-type:none}ul.lst-kix_82io1qj7fu80-5{list-style-type:none}ul.lst-kix_82io1qj7fu80-6{list-style-type:none}.lst-kix_b58kovzf3v0p-3>li:before{content:"\0025cf  "}.lst-kix_b58kovzf3v0p-2>li:before{content:"\0025a0  "}.lst-kix_b58kovzf3v0p-1>li:before{content:"\0025cb  "}ul.lst-kix_b58kovzf3v0p-3{list-style-type:none}ul.lst-kix_b58kovzf3v0p-4{list-style-type:none}.lst-kix_b58kovzf3v0p-0>li:before{content:"\0025cf  "}ul.lst-kix_b58kovzf3v0p-1{list-style-type:none}ul.lst-kix_b58kovzf3v0p-2{list-style-type:none}ul.lst-kix_b58kovzf3v0p-0{list-style-type:none}ul.lst-kix_b58kovzf3v0p-7{list-style-type:none}ul.lst-kix_b58kovzf3v0p-8{list-style-type:none}ul.lst-kix_b58kovzf3v0p-5{list-style-type:none}ul.lst-kix_b58kovzf3v0p-6{list-style-type:none}.lst-kix_40j8fboaaegi-1>li:before{content:"\0025cb  "}.lst-kix_40j8fboaaegi-0>li:before{content:"\0025cf  "}.lst-kix_40j8fboaaegi-7>li:before{content:"\0025cb  "}.lst-kix_40j8fboaaegi-8>li:before{content:"\0025a0  "}ul.lst-kix_qlsefhda3coc-0{list-style-type:none}ul.lst-kix_qlsefhda3coc-6{list-style-type:none}.lst-kix_40j8fboaaegi-2>li:before{content:"\0025a0  "}ul.lst-kix_qlsefhda3coc-5{list-style-type:none}ul.lst-kix_qlsefhda3coc-8{list-style-type:none}ul.lst-kix_qlsefhda3coc-7{list-style-type:none}ul.lst-kix_qlsefhda3coc-2{list-style-type:none}.lst-kix_40j8fboaaegi-3>li:before{content:"\0025cf  "}.lst-kix_40j8fboaaegi-4>li:before{content:"\0025cb  "}ul.lst-kix_qlsefhda3coc-1{list-style-type:none}ul.lst-kix_qlsefhda3coc-4{list-style-type:none}ul.lst-kix_qlsefhda3coc-3{list-style-type:none}.lst-kix_40j8fboaaegi-5>li:before{content:"\0025a0  "}.lst-kix_40j8fboaaegi-6>li:before{content:"\0025cf  "}ul.lst-kix_hbehtjqhofbd-1{list-style-type:none}ul.lst-kix_hbehtjqhofbd-0{list-style-type:none}ul.lst-kix_hbehtjqhofbd-3{list-style-type:none}ul.lst-kix_hbehtjqhofbd-2{list-style-type:none}ul.lst-kix_hbehtjqhofbd-5{list-style-type:none}ul.lst-kix_hbehtjqhofbd-4{list-style-type:none}ul.lst-kix_hbehtjqhofbd-7{list-style-type:none}ul.lst-kix_hbehtjqhofbd-6{list-style-type:none}ul.lst-kix_hbehtjqhofbd-8{list-style-type:none}.lst-kix_7cq5v3b5tpyt-3>li:before{content:"\0025cf  "}ul.lst-kix_7cq5v3b5tpyt-0{list-style-type:none}ul.lst-kix_7cq5v3b5tpyt-1{list-style-type:none}.lst-kix_7cq5v3b5tpyt-0>li:before{content:"\0025cf  "}.lst-kix_7cq5v3b5tpyt-4>li:before{content:"\0025cb  "}ul.lst-kix_7cq5v3b5tpyt-6{list-style-type:none}ul.lst-kix_7cq5v3b5tpyt-7{list-style-type:none}.lst-kix_yxtqdenm9vwf-8>li:before{content:"\0025a0  "}ul.lst-kix_7cq5v3b5tpyt-8{list-style-type:none}.lst-kix_7cq5v3b5tpyt-1>li:before{content:"\0025cb  "}ul.lst-kix_7cq5v3b5tpyt-2{list-style-type:none}ul.lst-kix_7cq5v3b5tpyt-3{list-style-type:none}.lst-kix_7cq5v3b5tpyt-2>li:before{content:"\0025a0  "}ul.lst-kix_7cq5v3b5tpyt-4{list-style-type:none}ul.lst-kix_7cq5v3b5tpyt-5{list-style-type:none}.lst-kix_7cq5v3b5tpyt-8>li:before{content:"\0025a0  "}.lst-kix_hbehtjqhofbd-8>li:before{content:"\0025a0  "}.lst-kix_7cq5v3b5tpyt-6>li:before{content:"\0025cf  "}.lst-kix_7cq5v3b5tpyt-7>li:before{content:"\0025cb  "}.lst-kix_yxtqdenm9vwf-7>li:before{content:"\0025cb  "}ul.lst-kix_40j8fboaaegi-7{list-style-type:none}ul.lst-kix_40j8fboaaegi-8{list-style-type:none}ul.lst-kix_40j8fboaaegi-5{list-style-type:none}.lst-kix_7cq5v3b5tpyt-5>li:before{content:"\0025a0  "}ul.lst-kix_40j8fboaaegi-6{list-style-type:none}.lst-kix_yxtqdenm9vwf-5>li:before{content:"\0025a0  "}.lst-kix_yxtqdenm9vwf-6>li:before{content:"\0025cf  "}ul.lst-kix_40j8fboaaegi-3{list-style-type:none}ul.lst-kix_40j8fboaaegi-4{list-style-type:none}.lst-kix_hbehtjqhofbd-4>li:before{content:"\0025cb  "}.lst-kix_hbehtjqhofbd-5>li:before{content:"\0025a0  "}.lst-kix_yxtqdenm9vwf-3>li:before{content:"\0025cf  "}.lst-kix_yxtqdenm9vwf-4>li:before{content:"\0025cb  "}.lst-kix_hbehtjqhofbd-2>li:before{content:"\0025a0  "}.lst-kix_hbehtjqhofbd-3>li:before{content:"\0025cf  "}.lst-kix_hbehtjqhofbd-6>li:before{content:"\0025cf  "}.lst-kix_hbehtjqhofbd-7>li:before{content:"\0025cb  "}.lst-kix_yxtqdenm9vwf-0>li:before{content:"\0025cf  "}.lst-kix_yxtqdenm9vwf-1>li:before{content:"\0025cb  "}.lst-kix_yxtqdenm9vwf-2>li:before{content:"\0025a0  "}.lst-kix_82io1qj7fu80-0>li:before{content:"\0025cf  "}.lst-kix_hbehtjqhofbd-1>li:before{content:"\0025cb  "}.lst-kix_82io1qj7fu80-3>li:before{content:"\0025cf  "}.lst-kix_hbehtjqhofbd-0>li:before{content:"\0025cf  "}.lst-kix_82io1qj7fu80-1>li:before{content:"\0025cb  "}.lst-kix_82io1qj7fu80-2>li:before{content:"\0025a0  "}.lst-kix_82io1qj7fu80-7>li:before{content:"\0025cb  "}.lst-kix_82io1qj7fu80-8>li:before{content:"\0025a0  "}.lst-kix_82io1qj7fu80-4>li:before{content:"\0025cb  "}.lst-kix_82io1qj7fu80-5>li:before{content:"\0025a0  "}.lst-kix_82io1qj7fu80-6>li:before{content:"\0025cf  "}ol{margin:0;padding:0}table td,table th{padding:0}.c10{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#333333;border-left-style:solid;border-bottom-width:0pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c3{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:17pt;font-family:"Arial";font-style:italic}.c13{color:#000000;text-decoration:none;vertical-align:baseline;font-family:"Arial";font-style:normal}.c12{background-color:#333333;font-family:"Consolas";color:#fcc28c;font-weight:400}.c14{background-color:#333333;font-family:"Consolas";color:#ffffff;font-weight:400}.c17{border-spacing:0;border-collapse:collapse;margin-right:auto}.c2{padding-top:18pt;padding-bottom:4pt;line-height:1.15;text-align:left}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c6{padding-top:14pt;padding-bottom:4pt;line-height:1.15;text-align:left}.c21{padding-top:14pt;padding-bottom:3pt;line-height:1.15;text-align:center}.c20{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:center}.c4{background-color:#333333;font-family:"Consolas";color:#d36363;font-weight:400}.c23{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c18{padding:0;margin:0}.c7{font-size:13pt;font-weight:700}.c22{font-weight:400;font-size:26pt}.c11{margin-left:36pt;padding-left:0pt}.c15{orphans:2;widows:2}.c5{font-size:17pt;font-weight:700}.c19{color:#000000}.c16{font-size:16pt}.c24{font-weight:700}.c9{height:11pt}.c8{height:0pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c23"><p class="c21 title" id="h.aohyyumgt5p0"><span class="c13 c22">TrustaBit - Security Audit</span></p><p class="c15 c20"><span class="c0">Casey Gardiner</span></p><h3 class="c6" id="h.4xmxk5nwljn7"><span class="c16 c19">Problem # 1 - </span><span class="c13 c7">Constant Functions</span></h3><p class="c1 c15"><span class="c0">The function is declared as constant. Currently, for functions the constant modifier is a synonym for view (which is the preferred option). Consider using view for functions and constant for state variables.</span></p><h2 class="c2" id="h.9pndbiubi0zw"><span class="c5">File: </span><span class="c3">FallbackToken.sol</span></h2><p class="c1 c15"><span class="c0">Lines: 11-16</span></p><p class="c1 c15"><span class="c0">Severity: 0</span></p><p class="c1 c15"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 124.00px;"><img alt="" src="images/image20.png" style="width: 624.00px; height: 124.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.oczxu91i61zj"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1 c15"><span class="c0">Lines: 12-17</span></p><p class="c1 c15"><span class="c0">Severity: 0</span></p><p class="c1 c15"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 120.00px;"><img alt="" src="images/image6.png" style="width: 624.00px; height: 120.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c15"><span class="c0">Lines: 641-643</span></p><p class="c1 c15"><span class="c0">Severity: 0</span></p><p class="c1 c15"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 586.00px; height: 59.00px;"><img alt="" src="images/image50.png" style="width: 586.00px; height: 59.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.xwiw44qaof9w"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale.sol</span></h2><p class="c1 c15"><span class="c0">Lines: 80-82</span></p><p class="c1 c15"><span class="c0">Severity: 0</span></p><p class="c1 c15"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 573.00px; height: 62.00px;"><img alt="" src="images/image54.png" style="width: 573.00px; height: 62.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c15 c9"><span class="c0"></span></p><p class="c1 c15"><span class="c13 c7">Recommendation</span></p><p class="c1 c15"><span class="c0">Declare functions which promise not modify the state as view and not constant. However, at the present time constant is an alias to view.</span></p><p class="c1 c15 c9"><span class="c0"></span></p><p class="c1 c15"><span class="c0">In the following example function is declared as constant:</span></p><p class="c1 c9 c15"><span class="c0"></span></p><a id="t.90af120fecbfacc886d090bbcc1f6d8875cfeabf"></a><a id="t.0"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">contract NewContract {<br> &nbsp; &nbsp;function hasEntry(address _account) public constant returns (bool) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12">return</span><span class="c14">&nbsp;listIndex.length &gt; </span><span class="c4">0</span><span class="c14">&nbsp;&amp;&amp; _account == listIndex[list[_account].index];<br> &nbsp; &nbsp;}<br>}</span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"></span></p><h3 class="c6" id="h.bdi93n67rfph"><span class="c19 c16">Problem # 2 - </span><span class="c13 c7">DoS by external function call in require</span></h3><p class="c1"><span class="c0">The contract that calls functions of other contracts should not rely on results of these functions. Be careful when verifying the result of external calls with require as called contract can always return false and prevent correct execution. Especially if the contract relies on state changes made by this function.</span></p><p class="c1"><span class="c0">This pattern is experimental and can report false issues. This pattern might be also triggered when</span></p><ul class="c18 lst-kix_7cq5v3b5tpyt-0 start"><li class="c1 c11"><span class="c0">accessing struct&#39;s field</span></li><li class="c1 c11"><span class="c0">using enum&#39;s element</span></li></ul><h2 class="c2" id="h.ljhil7vm59yd"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 357-357</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image44.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 543-543</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 20.00px;"><img alt="" src="images/image32.png" style="width: 624.00px; height: 20.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 548-548</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image39.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 555-555</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image11.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 561-561</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 18.67px;"><img alt="" src="images/image56.png" style="width: 624.00px; height: 18.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.ovkscs5jujkr"><span class="c5">File: </span><span class="c3">TrustaBitToken.sol</span></h2><p class="c1"><span class="c0">Lines: 65-65</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 22.67px;"><img alt="" src="images/image57.png" style="width: 624.00px; height: 22.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c13 c7">Recommendation</span></p><p class="c1"><span class="c0">To avoid this vulnerability, you can use the Checks-Effects-Interactions pattern.</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Consider a simple auction contract:</span></p><a id="t.10139984680bc16e3061ff09fc9c238cea123133"></a><a id="t.1"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">pragma solidity ^</span><span class="c4">0.4.5</span><span class="c14">;<br>contract Auction {<br> &nbsp; &nbsp;address currentLeader;<br> &nbsp; &nbsp;uint highestBid;<br><br> &nbsp; &nbsp;function bid() payable {<br> &nbsp; &nbsp; &nbsp; &nbsp;require(msg.value &gt; highestBid);<br> &nbsp; &nbsp; &nbsp; &nbsp;require(currentLeader.send(highestBid)); // Refund the old leader, </span><span class="c12">if</span><span class="c14">&nbsp;it fails then revert<br> &nbsp; &nbsp; &nbsp; &nbsp;currentLeader = msg.sender;<br> &nbsp; &nbsp; &nbsp; &nbsp;highestBid = msg.value;<br> &nbsp; &nbsp;}<br>}<br></span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">When it tries to refund the old leader, it reverts if the refund fails. This means that a malicious bidder can become the leader while making sure that any refunds to their address will always fail. In this way, they can prevent anyone else from calling the bid() function, and stay the leader forever.</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">To avoid this problem, check the return value of external calls:</span></p><a id="t.bc7354ad1b6d06f730ff76d2e8ed9e28afa7ac72"></a><a id="t.2"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">pragma solidity ^</span><span class="c4">0.4.5</span><span class="c14">;<br>contract Auction {<br> &nbsp; &nbsp;address currentLeader;<br> &nbsp; &nbsp;uint highestBid;<br><br> &nbsp; &nbsp;mapping (address =&gt; uint) oldbids;<br><br> &nbsp; &nbsp;function bid() payable {<br> &nbsp; &nbsp; &nbsp; &nbsp;require(msg.value &gt; highestBid);<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12">if</span><span class="c14">&nbsp;(currentLeader.send(highestBid)) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// good<br> &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class="c12">else</span><span class="c14">&nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;oldbids[currentLeader] += highestBid;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;currentLeader = msg.sender;<br> &nbsp; &nbsp; &nbsp; &nbsp;highestBid = msg.value;<br> &nbsp; &nbsp;}<br><br> &nbsp; &nbsp;function withdraw() {<br> &nbsp; &nbsp; &nbsp; &nbsp;uint bids = oldbids[msg.sender];<br> &nbsp; &nbsp; &nbsp; &nbsp;oldbids[msg.sender] = </span><span class="c4">0</span><span class="c14">;<br> &nbsp; &nbsp; &nbsp; &nbsp;msg.sender.transfer(bids);<br> &nbsp; &nbsp;}<br>}</span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"></span></p><h3 class="c6" id="h.mvd753b4ywie"><span class="c19 c16">Problem # 3 - </span><span class="c13 c7">Using the approve function of the ERC-20 standard</span></h3><p class="c1"><span class="c0">The approve function of ERC-20 might lead to vulnerabilities.</span></p><h2 class="c2" id="h.dlw3wosf1e6p"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 211-215</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 96.00px;"><img alt="" src="images/image55.png" style="width: 624.00px; height: 96.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 370-372</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 52.00px;"><img alt="" src="images/image48.png" style="width: 624.00px; height: 52.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.v25s1kwg36a8"><span class="c5">File: </span><span class="c3">TrustaBitToken.sol</span></h2><p class="c1"><span class="c0">Lines: 78-80</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 53.33px;"><img alt="" src="images/image52.png" style="width: 624.00px; height: 53.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">In the following contract the function approve is used</span></p><a id="t.4f437c9226b384fa76b59f10d216cb2b30ee99cd"></a><a id="t.3"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">pragma solidity ^</span><span class="c4">0.4.5</span><span class="c14">;<br>contract StandardToken </span><span class="c12">is</span><span class="c14">&nbsp;ERC20, BasicToken {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function approve(address _spender, uint256 _value) public returns (bool) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allowed[msg.sender][_spender] = _value;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Approval(msg.sender, _spender, _value);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c12">return</span><span class="c14">&nbsp;true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>}<br></span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c7">Recommendation</span></p><p class="c1"><span class="c0">Only use the approve function of the ERC-20 standard to change allowed amount to 0 or from 0 (wait till transaction is mined and approved).</span></p><h3 class="c6" id="h.w55oyw22ckyw"><span class="c19 c16">Problem # 4 - </span><span class="c13 c7">Functions transfer and transferFrom of ERC-20 Token should throw.</span></h3><p class="c1"><span class="c0">Functions of ERC-20 Token Standard should throw in special cases:</span></p><ul class="c18 lst-kix_40j8fboaaegi-0 start"><li class="c1 c11"><span class="c0">transfer should throw if the _from account balance does not have enough tokens to spend.</span></li><li class="c1 c11"><span class="c0">transferFrom should throw unless the _from account has deliberately authorized the sender of the message via some mechanism.</span></li></ul><h2 class="c2" id="h.f3qsw1edsz37"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 366-368</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 552.00px; height: 45.00px;"><img alt="" src="images/image25.png" style="width: 552.00px; height: 45.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.vwyd2t2mkg9o"><span class="c5">File: </span><span class="c3">TrustaBitToken.sol</span></h2><p class="c1"><span class="c0">Lines: 74-76</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 556.00px; height: 43.00px;"><img alt="" src="images/image24.png" style="width: 556.00px; height: 43.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c7">Recommendation</span></p><p class="c1"><span class="c0">The ERC20 standard recommends throwing exceptions in functions transfer and transferFrom.</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">The following example shows the transfer function, which does not throw as recommended by ERC-20 Standard:</span></p><a id="t.9b284be69ef9a5c9b79b4979679b971bad3ccd6a"></a><a id="t.4"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">contract SomeToken {<br> &nbsp; &nbsp;mapping(address =&gt; uint256) balances;<br> &nbsp; &nbsp;event Transfer(address indexed _from, address indexed _to, uint256 _value);<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;function transfer(address _to, uint _value) public returns (bool) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12">if</span><span class="c14">&nbsp;(_value &gt; balances[msg.sender] || _value &gt; balances[_to] + _value) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12">return</span><span class="c14">&nbsp;false;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;// SafeMath.sub will throw </span><span class="c12">if</span><span class="c14">&nbsp;there </span><span class="c12">is</span><span class="c14">&nbsp;</span><span class="c12">not</span><span class="c14">&nbsp;enough balance.<br> &nbsp; &nbsp; &nbsp; &nbsp;balances[msg.sender] = balances[msg.sender] - _value;<br> &nbsp; &nbsp; &nbsp; &nbsp;balances[_to] = balances[_to] + _value;<br> &nbsp; &nbsp; &nbsp; &nbsp;Transfer(msg.sender, _to, _value);<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12">return</span><span class="c14">&nbsp;true;<br> &nbsp; &nbsp;}<br>}</span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"></span></p><h3 class="c6" id="h.elm8gxgab17z"><span class="c19 c16">Problem # 5 - </span><span class="c13 c7">Costly loop</span></h3><p class="c1"><span class="c0">Ethereum is a very resource-constrained environment. Prices per computational step are orders of magnitude higher than with centralized providers. Moreover, Ethereum miners impose a limit on the total number of gas consumed in a block. If array.length is large enough, the function exceeds the block gas limit, and transactions calling it will never be confirmed:</span></p><p class="c1 c9"><span class="c0"></span></p><a id="t.c3780bcd16240f1a4dc04f3fb35fceefb2115eb1"></a><a id="t.5"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c12">for</span><span class="c14">&nbsp;(uint256 i = </span><span class="c4">0</span><span class="c14">; i &lt; array.length ; i++) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosltyFunc();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"><br></span></p><p class="c1"><span class="c0">This becomes a security issue, if an external actor influences array.length. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.g., if array enumerates all registered addresses, an adversary can register many addresses, causing the problem described above.</span></p><h2 class="c2" id="h.n62t6jei2j1h"><span class="c5">File: </span><span class="c3">MilestoneCrowdsale.sol</span></h2><p class="c1"><span class="c0">Lines: 96-101</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 116.00px;"><img alt="" src="images/image29.png" style="width: 624.00px; height: 116.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.p76cz0wsw4ki"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 477-482</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 114.67px;"><img alt="" src="images/image13.png" style="width: 624.00px; height: 114.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 761-766</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 118.67px;"><img alt="" src="images/image46.png" style="width: 624.00px; height: 118.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.l6vqfohqyksk"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale.sol</span></h2><p class="c1"><span class="c0">Lines: 200-205</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 116.00px;"><img alt="" src="images/image36.png" style="width: 624.00px; height: 116.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c7">Recommendation</span></p><p class="c1"><span class="c0">Avoid loops with big or unknown number of steps. </span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">In the following example, an attacker may register many addresses, causing the excess of the gas limit:</span></p><p class="c1 c9"><span class="c0"></span></p><a id="t.79244ff9f8b2ac4d7f65b5e345ff10936b048199"></a><a id="t.6"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">contract GasLimitAndLoops {<br> &nbsp; &nbsp;address[] internal investors;<br> &nbsp; &nbsp;mapping(address =&gt; uint) public balances;<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;function collectInvestment() external returns (uint) {<br> &nbsp; &nbsp; &nbsp; &nbsp;uint sum = </span><span class="c4">0</span><span class="c14">;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12">for</span><span class="c14">&nbsp;(uint i = </span><span class="c4">0</span><span class="c14">; i &lt; investors.length; i++) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sum += balances[investors[i]];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balances[investors[i]] = </span><span class="c4">0</span><span class="c14">;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;msg.sender.transfer(sum);<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;function invest() external payable {<br> &nbsp; &nbsp; &nbsp; &nbsp;investors.push(msg.sender);<br> &nbsp; &nbsp; &nbsp; &nbsp;balances[msg.sender] = msg.value;<br> &nbsp; &nbsp;}<br>}<br></span></p></td></tr></tbody></table><p class="c1"><span><br></span><span class="c16">Problem # 6 - </span><span class="c13 c7">No payable fallback function</span></p><p class="c1"><span class="c0">The contract does not have payable fallback. All attempts to transfer or send ether to this contract will be reverted.</span></p><h2 class="c2" id="h.2jz1stisbuxk"><span class="c5">File: </span><span class="c3">FallbackToken.sol</span></h2><p class="c1"><span class="c0">Lines: 9-17</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 177.33px;"><img alt="" src="images/image53.png" style="width: 624.00px; height: 177.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 20-22</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 56.00px;"><img alt="" src="images/image42.png" style="width: 624.00px; height: 56.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.8broavuui8qe"><span class="c5">File: </span><span class="c3">MilestoneCrowdsale.sol</span></h2><p class="c1"><span class="c0">Lines: 5-132</span></p><p class="c1"><span class="c0">Severity: 1</span></p><h2 class="c2" id="h.obufr08elvfi"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 10-18</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 174.67px;"><img alt="" src="images/image33.png" style="width: 624.00px; height: 174.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 21-23</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 58.67px;"><img alt="" src="images/image28.png" style="width: 624.00px; height: 58.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 32-67</span></p><p class="c1"><span>Severity: 1</span></p><p class="c1"><span class="c0">Lines: 111-116</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 116.00px;"><img alt="" src="images/image18.png" style="width: 624.00px; height: 116.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 124-154</span></p><p class="c1"><span>Severity: 1</span></p><p class="c1"><span class="c0">Lines: 162-167</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 101.33px;"><img alt="" src="images/image2.png" style="width: 624.00px; height: 101.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 178-250</span></p><p class="c1"><span>Severity: 1</span></p><p class="c1"><span class="c0">Lines: 261-296</span></p><p class="c1"><span>Severity: 1</span></p><p class="c1"><span class="c0">Lines: 343-345</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 50.67px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 50.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 386-513</span></p><p class="c1"><span>Severity: 1</span></p><p class="c1"><span class="c0">Lines: 523-567</span></p><p class="c1"><span class="c0">Severity: 1</span></p><h2 class="c2" id="h.t6hzrf6sphaw"><span class="c5">File: </span><span class="c3">TrustaBitToken.sol</span></h2><p class="c1"><span class="c0">Lines: 51-53</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 50.67px;"><img alt="" src="images/image10.png" style="width: 624.00px; height: 50.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c24">Recommendation</span></p><p class="c1"><span>Implement </span><span class="c14">payable</span><span>&nbsp;fallback, if the contract should accept payments via </span><span class="c14">transfer</span><span>&nbsp;or </span><span class="c14">send</span><span class="c0">.</span></p><p class="c1"><span class="c0">In the following example, the contract rejects payments:<br></span></p><a id="t.199d87652e4d109fec0056fc25301a9bf6d20a64"></a><a id="t.7"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">contract DontWantYourEtherForFree {<br> &nbsp; &nbsp;function someUsefullFunction() public payable {<br> &nbsp; &nbsp; &nbsp; &nbsp;// do some meaningful work<br> &nbsp; &nbsp;}<br><br> &nbsp; &nbsp;function () {<br> &nbsp; &nbsp; &nbsp; &nbsp;// dont receive ether via fallback<br> &nbsp; &nbsp;}<br>}</span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"></span></p><h3 class="c6" id="h.qztmn4w7ekg7"><span class="c19 c16">Problem # 7 - </span><span class="c13 c7">Compiler version not fixed</span></h3><p class="c1"><span class="c0">Solidity source files indicate the versions of the compiler they can be compiled with.</span></p><p class="c1 c9"><span class="c0"><br></span></p><a id="t.aceddb86f9c1169049028d1d50dfb7f64893dbc3"></a><a id="t.8"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">pragma solidity ^</span><span class="c4">0.4.17</span><span class="c14">; // bad: compiles w </span><span class="c4">0.4.17</span><span class="c14">&nbsp;</span><span class="c12">and</span><span class="c14">&nbsp;above<br>pragma solidity </span><span class="c4">0.4.17</span><span class="c14">; // good : compiles w </span><span class="c4">0.4.17</span><span class="c14">&nbsp;only</span></p></td></tr></tbody></table><p class="c1"><span class="c0"><br>It is recommended to follow the latter example, as future compiler versions may handle certain language constructions in a way the developer did not foresee.</span></p><h2 class="c2" id="h.7ryr6l64fsbo"><span class="c5">File: </span><span class="c3">FallbackToken.sol</span></h2><p class="c1"><span class="c0">Lines: 1-1</span></p><p class="c1"><span class="c0">Severity: 2</span></p><h2 class="c2" id="h.pd0yjay9zblf"><span class="c5">File: </span><span class="c3">MilestoneCrowdsale.sol</span></h2><p class="c1"><span class="c0">Lines: 1-1</span></p><p class="c1"><span class="c0">Severity: 2</span></p><h2 class="c2" id="h.j1ntkyyqoszs"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 1-1</span></p><p class="c1"><span class="c0">Severity: 2</span></p><h2 class="c2" id="h.yxc7e29jhdl3"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale.sol</span></h2><p class="c1"><span class="c0">Lines: 1-1</span></p><p class="c1"><span class="c0">Severity: 2</span></p><h2 class="c2" id="h.cfbz61f196y0"><span class="c5">File: </span><span class="c3">TrustaBitToken.sol</span></h2><p class="c1"><span class="c0">Lines: 1-1</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c7">Recommendation</span></p><p class="c1"><span class="c0">Specify the exact compiler version (pragma solidity x.y.z;). </span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">In the following example, &#1072;n unsafe way to specify versions of the compiler is used: </span></p><a id="t.3923256286671335815baa7a23131b7a60bb551a"></a><a id="t.9"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">pragma solidity ^</span><span class="c4">0.4.17</span><span class="c14">;</span></p></td></tr></tbody></table><p class="c1"><span class="c0">Safe alternative:</span></p><a id="t.1931391a6f019084c7e168f0f8c56bfd98cde072"></a><a id="t.10"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">pragma solidity </span><span class="c4">0.4.17</span><span class="c14">;</span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"></span></p><h3 class="c6" id="h.bsoejlvogsm9"><span class="c19 c16">Problem # 8 - </span><span class="c7 c13">Redundant fallback function</span></h3><p class="c1"><span class="c0">The payment rejection fallback is redundant.</span></p><p class="c1"><span class="c0">Contracts should reject unexpected payments. Before Solidity 0.4.0, it was done manually:<br></span></p><a id="t.75ed73721bc38d6f619b6b6117738a9be752f8ec"></a><a id="t.11"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">function () payable { throw ; }</span></p></td></tr></tbody></table><p class="c1"><span class="c0"><br><br>Starting from Solidity 0.4.0, contracts without a fallback function automatically revert payments, making the code above redundant.</span></p><h2 class="c2" id="h.1v0o6pb0at91"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 343-345</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 50.67px;"><img alt="" src="images/image35.png" style="width: 624.00px; height: 50.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.2g8pz3ailg7e"><span class="c5">File: </span><span class="c3">TrustaBitToken.sol</span></h2><p class="c1"><span class="c0">Lines: 51-53</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 53.33px;"><img alt="" src="images/image38.png" style="width: 624.00px; height: 53.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c7">Recommendation</span></p><p class="c1"><span class="c0">Remove the function to save space: the contract will reject payments automatically. </span></p><p class="c1"><span class="c0">In the following example, the payment rejection fallback is redundant:</span></p><a id="t.b91cd3d009aeade121f0418e1df3ca4f9795a50e"></a><a id="t.12"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">pragma solidity </span><span class="c4">0.4.8</span><span class="c14">;<br>contract TestContract1 {<br> &nbsp; &nbsp;function() payable {<br> &nbsp; &nbsp; &nbsp; &nbsp;throw;<br> &nbsp; &nbsp;}<br>}</span></p></td></tr></tbody></table><p class="c1"><span><br></span><span class="c16">Problem # 9 - </span><span class="c13 c7">Reentrancy</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Any interaction from a contract (A) with another contract (B) and any transfer of Ether hands over control to that contract (B). This makes it possible for B to call back into A before this interaction is completed.</span></p><p class="c1"><span class="c0">This pattern is experimental and can report false issues. This pattern might also be triggered when</span></p><ul class="c18 lst-kix_qlsefhda3coc-0 start"><li class="c1 c11"><span class="c0">accessing struct&#39;s field</span></li><li class="c1 c11"><span class="c0">using enum&#39;s element</span></li></ul><h2 class="c2" id="h.87vl7fxm4b1b"><span class="c5">File: </span><span class="c3">MilestoneCrowdsale.sol</span></h2><p class="c1"><span class="c0">Lines: 62-62</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image15.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 70-70</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 18.67px;"><img alt="" src="images/image47.png" style="width: 624.00px; height: 18.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.urkrogc4bjtk"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 194-194</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 16.00px;"><img alt="" src="images/image7.png" style="width: 624.00px; height: 16.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 195-195</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image22.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 196-196</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image37.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 234-234</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 16.00px;"><img alt="" src="images/image61.png" style="width: 624.00px; height: 16.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 280-280</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image30.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 281-281</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image41.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 357-357</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image5.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 443-443</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 16.00px;"><img alt="" src="images/image9.png" style="width: 624.00px; height: 16.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 451-451</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image27.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 543-543</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image40.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 548-548</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image17.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 549-549</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image34.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 555-555</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image58.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 556-556</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image43.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 561-561</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image4.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 564-564</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image51.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 677-677</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 12.00px;"><img alt="" src="images/image26.png" style="width: 624.00px; height: 12.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 721-721</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image45.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 730-730</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image16.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 739-739</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image23.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.ded8xqh4o481"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale.sol</span></h2><p class="c1"><span class="c0">Lines: 116-116</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image21.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 160-160</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 16.00px;"><img alt="" src="images/image60.png" style="width: 624.00px; height: 16.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 169-169</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image19.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Lines: 178-178</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image3.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.j0l4swq1khs6"><span class="c5">File: </span><span class="c3">TrustaBitToken.sol</span></h2><p class="c1"><span class="c0">Lines: 65-65</span></p><p class="c1"><span class="c0">Severity: 3</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image59.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c7">Recommendation</span></p><p class="c1"><span class="c0">To avoid reentrancy, you can use the Checks-Effects-Interactions pattern as outlined further below:</span></p><p class="c1 c9"><span class="c0"></span></p><a id="t.55b8fd343d26357fce82e9c5378648e99716d3a5"></a><a id="t.13"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">pragma solidity ^</span><span class="c4">0.4.11</span><span class="c14">;<br>contract Fund {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/// Mapping of ether shares of the contract.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mapping(address =&gt; uint) shares;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/// Withdraw your share.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function withdraw() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var share = shares[msg.sender];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shares[msg.sender] = </span><span class="c4">0</span><span class="c14">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.sender.transfer(share);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"><br></span></p><p class="c1"><span class="c0">Note that reentrancy is not only an effect of Ether transfer but of any function call on another contract. Furthermore, you also have to take multi-contract situations into account. A called contract could modify the state of another contract you depend on.</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c16">Problem # 10 - </span><span class="c13 c7">Revert-function in the body of the conditional operator if</span></p><p class="c1"><span>Using the construction </span><span class="c12">if</span><span class="c14">&nbsp;(condition) {revert();}</span><span>&nbsp;instead of </span><span class="c14">require(condition);</span></p><h2 class="c2" id="h.ab2qio3l1h33"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 329-331</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 52.00px;"><img alt="" src="images/image14.png" style="width: 624.00px; height: 52.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.crw71iakuzc4"><span class="c5">File: </span><span class="c3">TrustaBitToken.sol</span></h2><p class="c1"><span class="c0">Lines: 37-39</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 53.33px;"><img alt="" src="images/image12.png" style="width: 624.00px; height: 53.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c7">Recommendation</span></p><p class="c1"><span>Use </span><span class="c14">require</span><span class="c0">&nbsp;for better code readability.</span></p><p class="c1"><span>Since the construction </span><span class="c12">if</span><span class="c14">&nbsp;(condition) {revert();}</span><span>&nbsp;is equivalent to </span><span class="c14">require(!condition);</span><span class="c0">.</span></p><p class="c1"><span><br>In the following example, in the body of if conditional operator </span><span class="c14">revert()</span><span class="c0">&nbsp;function is used:</span></p><a id="t.ed055c43a9cdae96d5dff21e217ebfcddb709b66"></a><a id="t.14"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">contract Holder {<br> &nbsp; &nbsp;uint public holdUntil; &nbsp; <br> &nbsp; &nbsp;address public holder;<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;function Holder(uint period) public payable {<br> &nbsp; &nbsp; &nbsp; &nbsp;holdUntil = now + period;<br> &nbsp; &nbsp; &nbsp; &nbsp;holder = msg.sender;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;function withdraw (uint a, uint b) external {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12">if</span><span class="c14">&nbsp;(now &lt; holdUntil){<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;revert();<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;holder.transfer(this.balance);<br> &nbsp; &nbsp;}<br>}</span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"></span></p><h3 class="c6" id="h.e5vqnda26bx"><span class="c19 c16">Problem # 11 - </span><span class="c13 c7">Timestamp dependence</span></h3><p class="c1"><span class="c0">The timestamp of the block can be slightly manipulated by the miner. One should not use timestamp exact value for critical components of the contract.</span></p><h2 class="c2" id="h.1nwqsqi5gtpq"><span class="c5">File: </span><span class="c3">MilestoneCrowdsale.sol</span></h2><p class="c1"><span class="c0">Lines: 62-62</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 17.33px;"><img alt="" src="images/image31.png" style="width: 624.00px; height: 17.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c2" id="h.3jrmtutgf4p3"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 443-443</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 18.67px;"><img alt="" src="images/image49.png" style="width: 624.00px; height: 18.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c7">Recommendation</span></p><p class="c1"><span>Block numbers and average block time can be used to estimate time, but this is not future proof as block times may change (such as the changes expected during Casper). Do not use </span><span class="c14">now</span><span class="c0">&nbsp;for randomness.</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">In the following example, the now can be manipulated by the miner so that he/she will always win:</span></p><a id="t.492f02e28b22dea7b725d6b6c8b3418d05bfb1ae"></a><a id="t.15"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">function oddOrEven(bool yourGuess) external payable returns (bool) {<br> &nbsp; &nbsp;</span><span class="c12">if</span><span class="c14">&nbsp;(yourGuess == now % </span><span class="c4">2</span><span class="c14">&nbsp;&gt; </span><span class="c4">0</span><span class="c14">) {<br> &nbsp; &nbsp; &nbsp; &nbsp;uint fee = msg.value / </span><span class="c4">10</span><span class="c14">;<br> &nbsp; &nbsp; &nbsp; &nbsp;msg.sender.transfer(msg.value * </span><span class="c4">2</span><span class="c14">&nbsp;- fee);<br> &nbsp; &nbsp;}<br>}<br></span></p></td></tr></tbody></table><p class="c1"><span><br></span><span class="c16">Problem # 12 - </span><span class="c13 c7">Unchecked math</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Solidity is prone to integer over- and underflow. Overflow leads to unexpected effects and can lead to loss of funds if exploited by a malicious account.</span></p><p class="c1 c9"><span class="c0"></span></p><h2 class="c2" id="h.5qahopy4dab8"><span class="c5">File: </span><span class="c3">MilestoneCrowdsale.sol</span></h2><p class="c1"><span class="c0">Lines: 61-61</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 61-61</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 80-80</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 81-81</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 81-81</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 82-82</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 82-82</span></p><p class="c1"><span class="c0">Severity: 2</span></p><h2 class="c2" id="h.pj4svaunidjp"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 356-356</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 374-374</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 442-442</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 442-442</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 461-461</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 462-462</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 462-462</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 463-463</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 463-463</span></p><p class="c1"><span class="c0">Severity: 1</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 677-677</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 689-689</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 693-693</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 697-697</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 701-701</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 746-746</span></p><p class="c1"><span class="c0">Severity: 2</span></p><h2 class="c2" id="h.ec4td7jci2ir"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale.sol</span></h2><p class="c1"><span class="c0">Lines: 116-116</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 128-128</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 132-132</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 136-136</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 140-140</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 185-185</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Pattern id: 7dc23a</span></p><h2 class="c2" id="h.lqkziyu09d3j"><span class="c5">File: </span><span class="c3">TrustaBitToken.sol</span></h2><p class="c1"><span class="c0">Lines: 64-64</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Lines: 82-82</span></p><p class="c1"><span class="c0">Severity: 2</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c7">Recommendation</span></p><p class="c1"><span class="c0">Check against over- and underflow (use the SafeMath library).</span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">In the following example, the integer overflow is possible:</span></p><a id="t.d8f73613d5e895fe5fc63eca93aa11fb11e2a28f"></a><a id="t.16"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">contract BinomialCoefficient {<br><br> &nbsp; &nbsp;function calculate(uint n, uint k) external pure returns (uint) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12">return</span><span class="c14">&nbsp;factorial(n) / factorial(k) / factorial(n - k);<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;function factorial(uint n) internal pure returns (uint fact) {<br> &nbsp; &nbsp; &nbsp; &nbsp;fact = </span><span class="c4">1</span><span class="c14">;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12">for</span><span class="c14">&nbsp;(var i = n; i &gt; </span><span class="c4">1</span><span class="c14">; i--) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fact *= i;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;}<br>}</span></p></td></tr></tbody></table><p class="c1"><span><br></span><span class="c14">BinomialCoefficient.factorial(</span><span class="c4">70</span><span class="c14">, </span><span class="c4">2</span><span class="c14">) </span><span class="c0">returns 0.</span></p><h3 class="c6" id="h.cqkme7e91jjp"><span class="c19 c16">Problem # 13 - </span><span class="c13 c7">Implicit visibility level</span></h3><p class="c1"><span class="c0">The default function visibility level in Solidity is public. Explicitly define function visibility to prevent confusion.</span></p><h2 class="c2" id="h.w7rpc3ppb3h"><span class="c5">File: </span><span class="c3">TrustaBitCrowdsale_04.01.sol</span></h2><p class="c1"><span class="c0">Lines: 127-127</span></p><p class="c1"><span class="c0">Severity: 0</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 14.67px;"><img alt="" src="images/image8.png" style="width: 624.00px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c7">Recommendation</span></p><p class="c1"><span class="c0">Avoid ambiguity: explicitly declare visibility levels.</span></p><p class="c1"><span class="c0">In the following example, a specific modifier is not used when declaring a function:<br></span></p><a id="t.2828992391444db6c96424d472d9f2e485386fe3"></a><a id="t.17"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">function foo();</span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"></span></p><p class="c1"><span class="c0">Preferred alternatives:</span></p><a id="t.51e5514890ea76fddfed71a5c684f043a1dd6a62"></a><a id="t.18"></a><table class="c17"><tbody><tr class="c8"><td class="c10" colspan="1" rowspan="1"><p class="c1"><span class="c14">function foo() public;<br>function foo() internal;</span></p></td></tr></tbody></table><p class="c1 c9"><span class="c0"></span></p></body></html>